"use strict";{const e=django.jQuery;e.fn.formset=function(t){const n=e.extend({},e.fn.formset.defaults,t),s=e(this),u=s.parent(),r=function(t,n,s){const o=new RegExp("("+n+"-(\\d+|__prefix__))"),i=n+"-"+s;e(t).prop("for")&&e(t).prop("for",e(t).prop("for").replace(o,i)),t.id&&(t.id=t.id.replace(o,i)),t.name&&(t.name=t.name.replace(o,i))},i=e("#id_"+n.prefix+"-TOTAL_FORMS").prop("autocomplete","off");let c=parseInt(i.val(),10);const a=e("#id_"+n.prefix+"-MAX_NUM_FORMS").prop("autocomplete","off"),d=e("#id_"+n.prefix+"-MIN_NUM_FORMS").prop("autocomplete","off");let o;const m=function(){if(o===null)if(s.prop("tagName")==="TR"){const e=s.eq(-1).children().length;u.append('<tr class="'+n.addCssClass+'"><td colspan="'+e+'"><a href="#">'+n.addText+"</a></tr>"),o=u.find("tr:last a")}else s.filter(":last").after('<div class="'+n.addCssClass+'"><a href="#">'+n.addText+"</a></div>"),o=s.filter(":last").next().find("a");o.on("click",f)},f=function(t){t.preventDefault();const d=e("#"+n.prefix+"-empty"),s=d.clone(!0);s.removeClass(n.emptyCssClass).addClass(n.formCssClass).attr("id",n.prefix+"-"+c),h(s),s.find("*").each(function(){r(this,n.prefix,i.val())}),s.insertBefore(e(d)),e(i).val(parseInt(i.val(),10)+1),c+=1,a.val()!==""&&a.val()-i.val()<=0&&o.parent().hide(),l(s.closest(".inline-group")),n.added&&n.added(s),s.get(0).dispatchEvent(new CustomEvent("formset:added",{bubbles:!0,detail:{formsetName:n.prefix}}))},h=function(e){e.is("tr")?e.children(":last").append('<div><a class="'+n.deleteCssClass+'" href="#">'+n.deleteText+"</a></div>"):e.is("ul")||e.is("ol")?e.append('<li><a class="'+n.deleteCssClass+'" href="#">'+n.deleteText+"</a></li>"):e.children(":first").append('<span><a class="'+n.deleteCssClass+'" href="#">'+n.deleteText+"</a></span>"),e.find("a."+n.deleteCssClass).on("click",p.bind(this))},p=function(t){t.preventDefault();const m=e(t.target),d=m.closest("."+n.formCssClass),f=d.closest(".inline-group"),u=d.prev();u.length&&u.hasClass("row-form-errors")&&u.remove(),d.remove(),c-=1,n.removed&&n.removed(d),document.dispatchEvent(new CustomEvent("formset:removed",{detail:{formsetName:n.prefix}}));const i=e("."+n.formCssClass);e("#id_"+n.prefix+"-TOTAL_FORMS").val(i.length),(a.val()===""||a.val()-i.length>0)&&o.parent().show(),l(f);let s,h;const p=function(){r(this,n.prefix,s)};for(s=0,h=i.length;s<h;s++)r(e(i).get(s),n.prefix,s),e(i.get(s)).find("*").each(p)},l=function(e){d.val()!==""&&d.val()-i.val()>=0?e.find(".inline-deletelink").hide():e.find(".inline-deletelink").show()};s.each(function(){e(this).not("."+n.emptyCssClass).addClass(n.formCssClass)}),s.filter("."+n.formCssClass+":not(.has_original):not(."+n.emptyCssClass+")").each(function(){h(e(this))}),l(s),o=n.addButton,m();const g=a.val()===""||a.val()-i.val()>0;return s.length&&g?o.parent().show():o.parent().hide(),this},e.fn.formset.defaults={prefix:"form",addText:"add another",deleteText:"remove",addCssClass:"add-row",deleteCssClass:"delete-row",emptyCssClass:"empty-row",formCssClass:"dynamic-form",added:null,removed:null,addButton:null},e.fn.tabularFormset=function(t,n){const s=e(this),o=function(){typeof DateTimeShortcuts!="undefined"&&(e(".datetimeshortcuts").remove(),DateTimeShortcuts.init())},i=function(){typeof SelectFilter!="undefined"&&(e(".selectfilter").each(function(e,t){SelectFilter.init(t.id,this.dataset.fieldName,!1)}),e(".selectfilterstacked").each(function(e,t){SelectFilter.init(t.id,this.dataset.fieldName,!0)}))},a=function(t){t.find(".prepopulated_field").each(function(){const o=e(this),n=o.find("input, select, textarea"),i=n.data("dependency_list")||[],s=[];e.each(i,function(e,n){s.push("#"+t.find(".field-"+n).find("input, select, textarea").attr("id"))}),s.length&&n.prepopulate(s,n.attr("maxlength"))})};return s.formset({prefix:n.prefix,addText:n.addText,formCssClass:"dynamic-"+n.prefix,deleteCssClass:"inline-deletelink",deleteText:n.deleteText,emptyCssClass:"empty-form",added:function(e){a(e),o(),i()},addButton:n.addButton}),s},e.fn.stackedFormset=function(t,n){const s=e(this),o=function(){e(t).find(".inline_label").each(function(t){const n=t+1;e(this).html(e(this).html().replace(/(#\d+)/g,"#"+n))})},i=function(){typeof DateTimeShortcuts!="undefined"&&(e(".datetimeshortcuts").remove(),DateTimeShortcuts.init())},a=function(){typeof SelectFilter!="undefined"&&(e(".selectfilter").each(function(e,t){SelectFilter.init(t.id,this.dataset.fieldName,!1)}),e(".selectfilterstacked").each(function(e,t){SelectFilter.init(t.id,this.dataset.fieldName,!0)}))},r=function(t){t.find(".prepopulated_field").each(function(){const o=e(this),n=o.find("input, select, textarea"),i=n.data("dependency_list")||[],s=[];e.each(i,function(e,n){let o=t.find(".form-row .field-"+n);o.length||(o=t.find(".form-row.field-"+n)),s.push("#"+o.find("input, select, textarea").attr("id"))}),s.length&&n.prepopulate(s,n.attr("maxlength"))})};return s.formset({prefix:n.prefix,addText:n.addText,formCssClass:"dynamic-"+n.prefix,deleteCssClass:"inline-deletelink",deleteText:n.deleteText,emptyCssClass:"empty-form",removed:o,added:function(e){r(e),i(),a(),o(e)},addButton:n.addButton}),s},e(document).ready(function(){e(".js-inline-admin-formset").each(function(){const s=e(this).data(),n=s.inlineFormset;let t;switch(s.inlineType){case"stacked":t=n.name+"-group .inline-related",e(t).stackedFormset(t,n.options);break;case"tabular":t=n.name+"-group .tabular.inline-related tbody:first > tr.form-row",e(t).tabularFormset(t,n.options);break}})})}